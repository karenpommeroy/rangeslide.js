!function(a,b,c){"undefined"!=typeof module&&module.exports?module.exports=c():"function"==typeof define&&define.amd?define(c):b[a]=c()}("rangeslide",this,function(){"use strict";function b(){this.init.apply(this,arguments)}function c(a,c){return new b(a,c)}var a={autoPlay:!1,autoPlayDelay:1e3,data:[],enableLabelClick:!0,enableMarkerClick:!0,enableTrackClick:!0,handlers:[],highlightSelectedLabels:!1,labelsPosition:"below",labelsWidth:60,leftLabel:"",loop:!0,markerSize:14,rightLabel:"",showLabels:!1,sideLabelsWidth:40,showTrackMarkersProgress:!1,showTicks:!0,showTrackMarkers:!1,showTrackProgress:!1,showValue:!1,startAlternateLabelsFromTop:!1,startPosition:0,stepSize:1,thumbHeight:16,thumbWidth:16,tickHeight:16,trackHeight:7,valueIndicatorOffset:5,valueIndicatorWidth:30,valueIndicatorHeight:30,valuePosition:"thumb",valueSource:"index"};return b.prototype={init:function(b,c){this.onThumbMouseMove=this.onThumbMouseMove.bind(this),this.onThumbMouseUp=this.onThumbMouseUp.bind(this),this.onThumbMouseDown=this.onThumbMouseDown.bind(this),this.onTrackClicked=this.onTrackClicked.bind(this),this.onLabelClicked=this.onLabelClicked.bind(this),this.onMarkerClicked=this.onMarkerClicked.bind(this),this.onThumbTransitionEnd=this.onThumbTransitionEnd.bind(this),this.onUpdateMarkersProgress=this.onUpdateMarkersProgress.bind(this),this.config=Object.assign({},a,c),this.__markersUpdateInterval,this.__value=this.getMarkerByIndex(this.config.startPosition||0),this.__trackElement,this.__trackProgressElement,this.__trackMarkerElements,this.__sliderElement,this.__thumbElement,this.__valueElement,this.__labelContainerElement,this.__labelContainerElementTop,this.__labelContainerElementBottom,this.__rightLabelElement,this.__leftLabelElement,this.__mouseStartPositionX,this.__thumbStart,this.__playInterval,this.checkIfTargetIsValid(b),this.setAutoPlay(this.config.autoPlay),this.__targetElement.appendChild(this.createUI());var d=this.config.thumbWidth,e=(this.__targetElement.clientWidth-d)/((this.config.data.length-1)/this.config.stepSize);this.snap(e*this.config.startPosition),this.fire("initialized",[this.__targetElement])},checkIfTargetIsValid:function(a){if(!a)throw new Error("Missing required attribute: target element (css selector or DOM node) must be provided");if(this.__isString(a))this.__targetElement=document.querySelector(a);else{if(!this.__isDOMElement(a))throw new Error("Incorrect type: target element must be DOM node or string css selector");this.__targetElement=a}},createUI:function(){var a=document.createDocumentFragment();if(this.__trackElement=this.createTrackElement(),this.__trackProgressElement=this.createTrackProgressElement(),this.__thumbElement=this.createThumbElement(),this.__sliderElement=this.createSliderElement(this.__trackElement,this.__trackProgressElement,this.__thumbElement),a.appendChild(this.__sliderElement),this.config.showLabels&&("above"===this.config.labelsPosition?(this.__labelContainerElement=this.createLabelsElement(),this.createLabels(this.__labelContainerElement,!1,!1,!0),a.insertBefore(this.__labelContainerElement,this.__sliderElement)):"alternate"===this.config.labelsPosition?(this.__labelContainerElementTop=this.createLabelsElement(),this.createLabels(this.__labelContainerElementTop,!0,!this.config.startAlternateLabelsFromTop,!0),this.__labelContainerElementBottom=this.createLabelsElement(),this.createLabels(this.__labelContainerElementBottom,!0,this.config.startAlternateLabelsFromTop,!1),a.insertBefore(this.__labelContainerElementTop,this.__sliderElement),a.appendChild(this.__labelContainerElementBottom)):(this.__labelContainerElement=this.createLabelsElement(),this.createLabels(this.__labelContainerElement,!1,!1,!1),a.appendChild(this.__labelContainerElement))),this.config.showValue&&(this.__valueElement=this.createValueElement(),this.__thumbElement.appendChild(this.__valueElement)),this.config.leftLabel&&(this.__leftLabelElement=this.createSideLabel(this.config.leftLabel),a.appendChild(this.__leftLabelElement),this.__leftLabelElement.style.left=-this.config.sideLabelsWidth+"px"),this.config.rightLabel&&(this.__rightLabelElement=this.createSideLabel(this.config.rightLabel),a.appendChild(this.__rightLabelElement),this.__rightLabelElement.style.right=-this.config.sideLabelsWidth+"px"),this.config.showTrackMarkers){this.__trackMarkerElements=this.createTrackMarkers();for(var b=this.__trackMarkerElements.length;b--;)this.__trackElement.appendChild(this.__trackMarkerElements[b])}return a},createTrackElement:function(){var a=document.createElement("div");return a.className="track noselect animated",a.style.height=this.config.trackHeight+"px",this.config.enableTrackClick&&(a.onclick=this.onTrackClicked),a},createTrackProgressElement:function(){var a=document.createElement("div");return a.className="track-progress noselect",a.style.height=this.config.trackHeight+"px",a},createThumbElement:function(){var a=document.createElement("div");return a.className="thumb noselect",a.style.width=this.config.thumbWidth+"px",a.style.marginTop=-this.config.thumbHeight/2-this.config.trackHeight/2+"px",a.style.height=this.config.thumbHeight+"px",a.onmousedown=this.onThumbMouseDown,a},createSideLabel:function(a){var b=document.createElement("div");return b.innerText=a,b.className="side-label noselect",b.style.width=this.config.sideLabelsWidth+"px",b},createSliderElement:function(a,b,c){var d=document.createElement("div");return d.className="slider noselect",d.appendChild(b),d.appendChild(a),d.appendChild(c),d},createValueElement:function(){var a=document.createElement("div");return a.className="value-indicator noselect","thumb"===this.config.valuePosition?(a.style.width=this.config.thumbWidth+"px",a.style.height=this.config.thumbHeight+"px",a.style.lineHeight=this.config.thumbHeight+"px"):(a.style.width=this.config.valueIndicatorWidth+"px",a.style.height=this.config.valueIndicatorHeight+"px",a.style.lineHeight=this.config.valueIndicatorHeight+"px",a.style.left=-this.config.valueIndicatorWidth/2+this.config.thumbWidth/2+"px"),"above"===this.config.valuePosition?(a.style.top=-this.config.valueIndicatorHeight/2-this.config.thumbHeight/2-this.config.trackHeight-this.config.valueIndicatorOffset+"px",a.classList.add("above")):"below"===this.config.valuePosition&&(a.style.top=this.config.valueIndicatorHeight/2+this.config.thumbHeight/2-this.config.trackHeight/2+this.config.valueIndicatorOffset+"px",a.classList.add("below")),a},createLabelsElement:function(){var a=document.createElement("div");return a.className="labels-container noselect",a},createLabels:function(a,b,c,d){for(var e=this.config.labelsWidth/(b?1:2)-this.config.thumbWidth/2,f=this.config.thumbWidth,g=this.config.data.length-1,i="((100% - "+f+"px) / "+g+")",j=c?1:0;j<=g;b?j+=2:j++){var k=document.createElement("div");if(k.className="tick-label noselect",k.style.width=this.config.labelsWidth*(b?2:1)+"px",k.id=this.__targetElement.id+"_label"+j,this.config.enableLabelClick&&(k.onclick=this.onLabelClicked),k.style.left="calc("+i+" * "+j+" - "+e+"px)",this.config.showTicks){var l=document.createElement("div");l.className="tick noselect",l.style.height=this.config.tickHeight+"px",k.appendChild(l)}var m=document.createElement("span");m.className="noselect",m.innerText=this.config.data[j].name,d?k.insertBefore(m,l):k.appendChild(m),a.appendChild(k)}d&&(a.style.height=14+(this.config.showTicks?this.config.tickHeight:0)+"px")},createTrackMarkers:function(){for(var a=this.config.markerSize/2-this.config.thumbWidth/2,b=this.config.thumbWidth,c=this.config.data.length-1,d=this.config.data.length,f="((100% - "+b+"px) / "+c+")",g=[];d--;){var h=document.createElement("div");h.className="track-marker noselect",h.style.width=this.config.markerSize+"px",h.style.height=this.config.markerSize+"px",h.style.top=-this.config.markerSize/2+this.config.trackHeight/2+"px",this.config.enableMarkerClick&&(h.onclick=this.onMarkerClicked,h.style.cursor="pointer"),h.style.left="calc("+f+" * "+d+" - "+a+"px)",g.push(h)}return g},getValue:function(){return this.__value},setValue:function(a){var b=this.__value;this.__value=this.getMarkerByIndex(a);var c=this.config.thumbWidth,d=(this.__targetElement.clientWidth-c)/((this.config.data.length-1)/this.config.stepSize);this.snap(d*a),this.onValueChanged(b,this.__value)},setValueByName:function(a){var b=this.__value;this.__value=this.getMarkerByName(a);var c=this.config.thumbWidth,d=(this.__targetElement.clientWidth-c)/((this.config.data.length-1)/this.config.stepSize);this.snap(d*this.__value.index),this.onValueChanged(b,this.__value)},setOption:function(a,b){this.config[a]=b,this.refresh()},refresh:function(){this.init(this.__targetElement,this.config),this.fire("refreshed",[this.__targetElement])},getElement:function(){return this.__targetElement},getThumbStart:function(){return isNaN(parseFloat(this.__thumbElement.style.left))?0:parseFloat(this.__thumbElement.style.left)},setAutoPlay:function(a){if(!a)return clearInterval(this.__playInterval),void this.fire("playStop",[this.__value,this.__targetElement]);this.__playInterval=setInterval(this.goToNextMarker.bind(this),this.config.autoPlayDelay),this.fire("playStart",[this.__value,this.__targetElement])},goToNextMarker:function(){var a=this.getValue().index+1;if(this.config.loop)a>this.config.data.length-1&&(a=0);else if(a>this.config.data.length-1)return void clearInterval(this.__playInterval);this.setValue(a)},snap:function(a){var b=this.config.thumbWidth,c=(this.__targetElement.clientWidth-b)/((this.config.data.length-1)/this.config.stepSize);this.__thumbElement.classList.add("animated");var e,d=a/c%1,f="0px";d<.5?(f=(a-c*d).toFixed(),this.__thumbElement.style.left=f+"px",e=Math.floor(a/c)):(e=Math.floor(a/c)+1,e<=this.config.data.length-1?(f=(a+c*(1-d)).toFixed(),this.__thumbElement.style.left=f+"px"):(f=(a-c*d).toFixed(),this.__thumbElement.style.left=f+"px",e=this.config.data.length-1)),this.config.showTrackProgress&&(this.__trackProgressElement.style.width=f+"px"),this.config.showTrackMarkersProgress&&(this.__markersUpdateInterval=setInterval(this.onUpdateMarkersProgress,50)),this.__thumbElement.addEventListener("webkitTransitionEnd",this.onThumbTransitionEnd),this.__thumbElement.addEventListener("otransitionend",this.onThumbTransitionEnd),this.__thumbElement.addEventListener("oTransitionEnd",this.onThumbTransitionEnd),this.__thumbElement.addEventListener("msTransitionEnd",this.onThumbTransitionEnd),this.__thumbElement.addEventListener("transitionend",this.onThumbTransitionEnd);var g=this.getMarkerByIndex(e);this.onValueChanged(this.__value,g),this.__value=g},setActiveLabel:function(a){var b=this.__targetElement.querySelector(".tick-label.selected"),c=this.__targetElement.querySelector("#"+this.__targetElement.id+"_label"+a);b&&b.classList.remove("selected"),c&&c.classList.add("selected")},onValueChanged:function(a,b){this.config.showValue&&(this.__valueElement.innerText=b[this.config.valueSource]),this.config.highlightSelectedLabels&&this.setActiveLabel(b.id),this.fire("valueChanged",[b,this.__targetElement])},onTrackClicked:function(a){this.snap(a.offsetX),this.fire("trackClicked",[this.__value,a.currentTarget])},onLabelClicked:function(a){this.snap(a.currentTarget.offsetLeft+this.config.labelsWidth/2),this.fire("labelClicked",[this.__value,a.currentTarget])},onMarkerClicked:function(a){this.snap(a.currentTarget.offsetLeft+this.config.markerSize/2),this.fire("markerClicked",[this.__value,a.currentTarget]),a.preventDefault(),a.stopPropagation()},onThumbMouseDown:function(a){this.__mouseStartPositionX=a.pageX,this.__thumbStart=this.getThumbStart(),this.fire("thumbDragStart",[this.__value,a.currentTarget]),window.addEventListener("mousemove",this.onThumbMouseMove),window.addEventListener("mouseup",this.onThumbMouseUp)},onThumbMouseUp:function(a){this.__thumbStart=this.getThumbStart(),this.snap(this.__thumbStart),this.fire("thumbDragEnd",[this.__value,a.currentTarget]),window.removeEventListener("mousemove",this.onThumbMouseMove),window.removeEventListener("mouseup",this.onThumbMouseUp)},onThumbMouseMove:function(a){var b=-1*(this.__mouseStartPositionX-a.pageX),c=this.__thumbStart+b;this.isPositionOutOfBounds(c)||(this.__thumbElement.style.left=c+"px"),this.fire("thumbDragged",[this.__value,a.currentTarget])},onThumbTransitionEnd:function(a){a.target.removeEventListener(a.type,this.onThumbTransitionEnd),a.target.classList.remove("animated"),this.config.showTrackMarkersProgress&&this.onUpdateMarkersProgress(),clearInterval(this.__markersUpdateInterval)},onUpdateMarkersProgress:function(){for(var a=this.__trackMarkerElements.length;a--;)this.__trackMarkerElements[a].offsetLeft<=this.__thumbElement.offsetLeft?this.__trackMarkerElements[a].classList.add("completed"):this.__trackMarkerElements[a].classList.remove("completed")},isPositionOutOfBounds:function(a){var b=this.config.data.length-1;return a>(this.__targetElement.clientWidth-this.config.thumbWidth)/b*b||a<0},getMarkerByIndex:function(a){return{index:a,name:this.config.data[a].name,item:this.config.data[a].item}},getMarkerByName:function(a){for(var b=0;b<this.config.data.length;b++)if(this.config.data[b].name===a)return{index:b,name:this.config.data[b].name,item:this.config.data[b].item}},fire:function(a,b){if(this.config.handlers&&this.config.handlers[a])for(var c=this.config.handlers[a].length;c--;)this.config.handlers[a][c].apply(this,b)},__isDOMElement:function(a){return a instanceof Element},__isString:function(a){return"string"==typeof a}},c});