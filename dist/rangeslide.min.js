!function(t,e){"function"==typeof define&&define.amd?define([],function(){return e()}):"object"==typeof module&&module.exports?module.exports=e():t.rangeslide=e()}(this,function(){"use strict";function t(t){this.__value=t,this.__element,this.__label}function e(){this.init.apply(this,arguments)}var i={autoPlay:!1,autoPlayDelay:1e3,data:[],enableLabelClick:!0,enableMarkerClick:!0,enableTrackClick:!0,handlers:[],highlightSelectedLabels:!1,labelsPosition:"below",labelsWidth:60,leftLabel:"",loop:!0,markerSize:14,mode:"single",rightLabel:"",showLabels:!1,showTrackMarkersProgress:!1,showTicks:!0,showTrackMarkers:!1,showTrackProgress:!1,showValue:!1,sideLabelsWidth:40,startAlternateLabelsFromTop:!1,startPosition:0,endPosition:1/0,stepSize:1,thumbHeight:16,thumbWidth:16,tickHeight:16,trackHeight:7,valueIndicatorOffset:5,valueIndicatorWidth:30,valueIndicatorHeight:30,valuePosition:"above",valueSource:"index"};return t.prototype={getElement:function(){return this.__element},getLabel:function(){return this.__label},getValue:function(){return this.__value},getRight:function(){return this.__element&&this.__element.offsetLeft+this.__element.offsetWidth},getLeft:function(){return this.__element&&this.__element.offsetLeft},setLeft:function(t){this.__element.style.left=t+"px"},setElement:function(t){this.__element=t},setValue:function(t){this.__value=t},addLabel:function(t){this.__label=t,this.__element&&this.__element.appendChild(t)},hide:function(){this.__element&&(this.__element.style.display="none")}},e.prototype={init:function(e,s){this.onThumbMouseMove=this.onThumbMouseMove.bind(this),this.onThumbMouseUp=this.onThumbMouseUp.bind(this),this.onThumbMouseDown=this.onThumbMouseDown.bind(this),this.onTrackClicked=this.onTrackClicked.bind(this),this.onLabelClicked=this.onLabelClicked.bind(this),this.onMarkerClicked=this.onMarkerClicked.bind(this),this.onThumbTransitionEnd=this.onThumbTransitionEnd.bind(this),this.onUpdateMarkersProgress=this.onUpdateMarkersProgress.bind(this),this.config=Object.assign({},i,s),this.__adjustConfiguration(),this.__multiThumbProximityBuffor=1.5,this.__markersUpdateInterval,this.__trackElement,this.__trackProgressElement,this.__trackMarkerElements,this.__sliderElement,this.__draggedThumb,this.__labelContainerElement,this.__labelContainerElementTop,this.__labelContainerElementBottom,this.__rightLabelElement,this.__leftLabelElement,this.__mouseStartPositionX,this.__playInterval,this.__thumbLeft=new t(this.getMarkerByIndex(this.config.startPosition)),this.__thumbRight=new t(this.getMarkerByIndex(this.config.endPosition)),this.checkIfTargetIsValid(e),this.setAutoPlay(this.config.autoPlay),this.__targetElement.appendChild(this.createUI()),this.__setThumbsInitialPositions(),this.fire("initialized",[this.__targetElement])},checkIfTargetIsValid:function(t){if(!t)throw new Error("Missing required attribute: target element (css selector or DOM node) must be provided");if(this.__isString(t))this.__targetElement=document.querySelector(t);else{if(!this.__isDOMElement(t))throw new Error("Incorrect type: target element must be DOM node or string css selector");this.__targetElement=t}},createUI:function(){var t=document.createDocumentFragment();if(this.__trackElement=this.createTrackElement(),this.__trackProgressElement=this.createTrackProgressElement(),this.__thumbLeft.setElement(this.createThumbElement("min-thumb")),this.isRangeMode()&&this.__thumbRight.setElement(this.createThumbElement("max-thumb")),this.__sliderElement=this.createSliderElement(this.__trackElement,this.__trackProgressElement,[this.__thumbLeft.getElement(),this.__thumbRight.getElement()]),t.appendChild(this.__sliderElement),this.config.showLabels&&("above"===this.config.labelsPosition?(this.__labelContainerElement=this.createLabelsElement(),this.createLabels(this.__labelContainerElement,!1,!1,!0),t.insertBefore(this.__labelContainerElement,this.__sliderElement)):"alternate"===this.config.labelsPosition?(this.__labelContainerElementTop=this.createLabelsElement(),this.createLabels(this.__labelContainerElementTop,!0,!this.config.startAlternateLabelsFromTop,!0),this.__labelContainerElementBottom=this.createLabelsElement(),this.createLabels(this.__labelContainerElementBottom,!0,this.config.startAlternateLabelsFromTop,!1),t.insertBefore(this.__labelContainerElementTop,this.__sliderElement),t.appendChild(this.__labelContainerElementBottom)):(this.__labelContainerElement=this.createLabelsElement(),this.createLabels(this.__labelContainerElement,!1,!1,!1),t.appendChild(this.__labelContainerElement))),this.config.showValue&&(this.__thumbLeft.addLabel(this.createValueElement()),this.isRangeMode()&&this.__thumbRight.addLabel(this.createValueElement())),this.config.leftLabel&&(this.__leftLabelElement=this.createSideLabel(this.config.leftLabel),t.appendChild(this.__leftLabelElement),this.__leftLabelElement.style.left=-this.config.sideLabelsWidth+"px"),this.config.rightLabel&&(this.__rightLabelElement=this.createSideLabel(this.config.rightLabel),t.appendChild(this.__rightLabelElement),this.__rightLabelElement.style.right=-this.config.sideLabelsWidth+"px"),this.config.showTrackMarkers){this.__trackMarkerElements=this.createTrackMarkers();for(var e=this.__trackMarkerElements.length;e--;)this.__trackElement.appendChild(this.__trackMarkerElements[e])}return this.isSelectMode()&&(this.__thumbLeft.hide(),this.__thumbRight.hide()),t},createTrackElement:function(){var t=document.createElement("div");return t.className="track noselect animated",t.style.height=this.config.trackHeight+"px",this.config.enableTrackClick&&(t.onclick=this.onTrackClicked),t},createTrackProgressElement:function(){var t=document.createElement("div");return t.className="track-progress noselect",t.style.height=this.config.trackHeight+"px",t},createThumbElement:function(t){var e=document.createElement("div");return e.className="thumb noselect "+t,e.style.width=this.config.thumbWidth+"px",e.style.marginTop=-this.config.thumbHeight/2-this.config.trackHeight/2+"px",e.style.height=this.config.thumbHeight+"px",e.onmousedown=this.onThumbMouseDown,e},createSideLabel:function(t){var e=document.createElement("div");return e.innerText=t,e.className="side-label noselect",e.style.width=this.config.sideLabelsWidth+"px",e},createSliderElement:function(t,e,i){var s=document.createElement("div"),n=i.length;for(s.className="slider noselect",s.appendChild(e),s.appendChild(t);n--;)i[n]&&s.appendChild(i[n]);return s},createValueElement:function(){var t=document.createElement("div");return t.className="value-indicator noselect","thumb"===this.config.valuePosition?(t.style.width=this.config.thumbWidth+"px",t.style.height=this.config.thumbHeight+"px",t.style.lineHeight=this.config.thumbHeight+"px"):(t.style.width=this.config.valueIndicatorWidth+"px",t.style.height=this.config.valueIndicatorHeight+"px",t.style.lineHeight=this.config.valueIndicatorHeight+"px",t.style.left=-this.config.valueIndicatorWidth/2+this.config.thumbWidth/2+"px"),"above"===this.config.valuePosition?(t.style.top=-this.config.valueIndicatorHeight/2-this.config.thumbHeight/2-this.config.trackHeight-this.config.valueIndicatorOffset+"px",t.classList.add("above")):"below"===this.config.valuePosition&&(t.style.top=this.config.valueIndicatorHeight/2+this.config.thumbHeight/2-this.config.trackHeight/2+this.config.valueIndicatorOffset+"px",t.classList.add("below")),t},createLabelsElement:function(){var t=document.createElement("div");return t.className="labels-container noselect",t},createLabels:function(t,e,i,s){for(var n=this.config.labelsWidth/(e?1:2)-this.config.thumbWidth/2,a=this.config.thumbWidth,h=this.config.data.length-1,r="((100% - "+a+"px) / "+h+")",o=i?1:0;o<=h;e?o+=2:o++){var l=document.createElement("div");if(l.className="tick-label noselect",l.style.width=this.config.labelsWidth*(e?2:1)+"px",l.id=this.__targetElement.id+"_label"+o,this.config.enableLabelClick&&(l.onclick=this.onLabelClicked),l.style.left="calc("+r+" * "+o+" - "+n+"px)",this.config.showTicks){var c=document.createElement("div");c.className="tick noselect",c.style.height=this.config.tickHeight+"px",l.appendChild(c)}var g=document.createElement("span");g.className="noselect",g.innerText=this.config.data[o][this.config.valueSource],s?l.insertBefore(g,c):l.appendChild(g),t.appendChild(l)}s&&(t.style.height=14+(this.config.showTicks?this.config.tickHeight:0)+"px")},createTrackMarkers:function(){for(var t=this.config.markerSize/2-this.config.thumbWidth/2,e=this.config.thumbWidth,i=this.config.data.length-1,s=this.config.data.length,n="((100% - "+e+"px) / "+i+")",a=[];s--;){var h=document.createElement("div");h.className="track-marker noselect",h.dataset.id=s,h.style.width=this.config.markerSize+"px",h.style.height=this.config.markerSize+"px",h.style.top=-this.config.markerSize/2+this.config.trackHeight/2+"px",this.config.enableMarkerClick&&(h.onclick=this.onMarkerClicked,h.style.cursor="pointer"),h.style.left="calc("+n+" * "+s+" - "+t+"px)",a.push(h)}return a},getValue:function(){return this.isRangeMode()?this.getRange():this.isSelectMode()?this.getSelection():this.__thumbLeft.getValue()},getMinValue:function(){return this.__thumbLeft.getValue()},getMaxValue:function(){return this.__thumbRight.getValue()},getRange:function(){for(var t=this.__thumbLeft.getValue().index,e=this.__thumbRight.getValue().index,i=[],s=t;s<=e;s++)i.push(this.getMarkerByIndex(s));return i},getSelection:function(){for(var t=this.__targetElement.querySelectorAll(".track-marker.selected"),e=[],i=0;i<t.length;i++)e.push(this.config.data[t[i].dataset.id]);return e},setValue:function(t,e){var i=e.getValue();e.setValue(this.getMarkerByIndex(t));var s=this.config.thumbWidth,n=(this.__targetElement.clientWidth-s)/((this.config.data.length-1)/this.config.stepSize);this.snap(n*t),this.onValueChanged(i,e.getValue(),e)},setMinValue:function(t){this.setValue(t,this.__thumbLeft)},setMaxValue:function(t){this.setValue(t,this.__thumbRight)},setOption:function(t,e){this.config[t]=e,this.refresh()},isRangeMode:function(){return"range"===this.config.mode},isSelectMode:function(){return"select"===this.config.mode},refresh:function(){this.init(this.__targetElement,this.config),this.fire("refreshed",[this.__targetElement])},getElement:function(){return this.__targetElement},getThumbStart:function(t){return isNaN(parseFloat(t.style.left))?0:parseFloat(t.style.left)},setAutoPlay:function(t){if(!this.isRangeMode()){if(!t)return clearInterval(this.__playInterval),void this.fire("playStop",[this.__thumbLeft.getValue(),this.__targetElement]);this.__playInterval=setInterval(this.goToNextMarker.bind(this),this.config.autoPlayDelay),this.fire("playStart",[this.__thumbLeft.getValue(),this.__targetElement])}},select:function(t){t.classList.toggle("selected")},goToNextMarker:function(){if(!this.isRangeMode()){var t=this.__thumbLeft.getValue().index+1;if(this.config.loop)t>this.config.data.length-1&&(t=0);else if(t>this.config.data.length-1)return void clearInterval(this.__playInterval);this.setValue(t)}},getClosestThumbElement:function(t){return Math.abs(this.__thumbLeft.getRight()-t)>Math.abs(this.__thumbRight.getLeft()-t)?this.__thumbRight:this.__thumbLeft},snap:function(t,e,i){var s=this.config.thumbWidth,n=(this.__targetElement.clientWidth-s)/((this.config.data.length-1)/this.config.stepSize),a=this.isRangeMode()?e||this.getClosestThumbElement(t):this.__thumbLeft;!i&&a.getElement().classList.add("animated");var h,r=t/n%1,o="0px";r<.5?(o=(t-n*r).toFixed(),a.setLeft(o),h=Math.floor(t/n)):(h=Math.floor(t/n)+1)<=this.config.data.length-1?(o=(t+n*(1-r)).toFixed(),a.setLeft(o)):(o=(t-n*r).toFixed(),a.setLeft(o),h=this.config.data.length-1),this.config.showTrackProgress&&(this.isRangeMode()?a.getElement().classList.contains("max-thumb")?(this.__trackProgressElement.style.left=this.__thumbLeft.getLeft(),this.__trackProgressElement.style.width=o-this.__thumbLeft.getLeft()+"px"):a.getElement().classList.contains("min-thumb")&&(this.__trackProgressElement.style.left=o+"px",this.__trackProgressElement.style.width=this.__thumbRight.getLeft()-o+"px"):this.__trackProgressElement.style.width=o+"px"),this.config.showTrackMarkersProgress&&(clearInterval(this.__markersUpdateInterval),this.__markersUpdateInterval=setInterval(this.onUpdateMarkersProgress,50)),a.getElement().addEventListener("webkitTransitionEnd",this.onThumbTransitionEnd),a.getElement().addEventListener("otransitionend",this.onThumbTransitionEnd),a.getElement().addEventListener("oTransitionEnd",this.onThumbTransitionEnd),a.getElement().addEventListener("msTransitionEnd",this.onThumbTransitionEnd),a.getElement().addEventListener("transitionend",this.onThumbTransitionEnd);var l=this.getMarkerByIndex(h);this.onValueChanged(a.getValue(),l,a),a.setValue(l)},setActiveLabel:function(t){var e=this.__targetElement.querySelector(".tick-label.selected"),i=this.__targetElement.querySelector("#"+this.__targetElement.id+"_label"+t);e&&e.classList.remove("selected"),i&&i.classList.add("selected")},onValueChanged:function(t,e,i){this.config.showValue&&(i.getLabel().innerText=e[this.config.valueSource]),this.config.highlightSelectedLabels&&this.setActiveLabel(e.index),this.fire("valueChanged",[e,this.__targetElement])},onTrackClicked:function(t){this.snap(t.offsetX),this.fire("trackClicked",[this.__thumbLeft.getValue(),t.currentTarget])},onLabelClicked:function(t){this.snap(t.currentTarget.offsetLeft+this.config.labelsWidth/2),this.fire("labelClicked",[this.__thumbLeft.getValue(),t.currentTarget])},onMarkerClicked:function(t){this.isSelectMode()?this.select(t.currentTarget):this.snap(t.currentTarget.offsetLeft+this.config.markerSize/2),this.fire("markerClicked",[this.__thumbLeft.getValue(),t.currentTarget]),t.preventDefault(),t.stopPropagation()},onThumbMouseDown:function(t){this.__mouseStartPositionX=t.pageX;var e=this.__getThumbFromElement(t.currentTarget);this.__draggedThumb=e,e.start=this.getThumbStart(t.currentTarget),this.fire("thumbDragStart",[e.getValue(),t.currentTarget]),window.addEventListener("mousemove",this.onThumbMouseMove),window.addEventListener("mouseup",this.onThumbMouseUp)},onThumbMouseUp:function(t){var e=this.__draggedThumb;e.start=this.getThumbStart(e.getElement()),this.snap(e.start),this.fire("thumbDragEnd",[e.getValue(),e.getElement()]),this.__draggedThumb=null,window.removeEventListener("mousemove",this.onThumbMouseMove),window.removeEventListener("mouseup",this.onThumbMouseUp)},onThumbMouseMove:function(t){var e=this.__draggedThumb,i=-1*(this.__mouseStartPositionX-t.pageX),s=e.start+i;if(this.isRangeMode()&&this.areThumbsTooClose())if(e.getElement().classList.contains("max-thumb")){if(s<e.getLeft())return}else if(e.getElement().classList.contains("min-thumb")&&s>e.getLeft())return;this.isPositionOutOfBounds(s)||e.setLeft(s),this.fire("thumbDragged",[e.getValue(),e.getElement()])},onThumbTransitionEnd:function(t){t.target.removeEventListener(t.type,this.onThumbTransitionEnd),t.target.classList.remove("animated"),this.config.showTrackMarkersProgress&&this.onUpdateMarkersProgress(),clearInterval(this.__markersUpdateInterval)},onUpdateMarkersProgress:function(){this.isRangeMode()?this.__updateMarkerRange():this.__updateMarkerProgress()},__adjustConfiguration:function(){var t=this.config.data.length-1;this.config.endPosition=this.config.endPosition>t?t:this.config.endPosition,this.isRangeMode()?(this.config.autoPlay=!1,this.config.loop=!1):this.isSelectMode()&&(this.config.showTrackMarkers=!0)},__getThumbFromElement:function(t){return t.classList.contains("max-thumb")?this.__thumbRight:t.classList.contains("min-thumb")?this.__thumbLeft:void 0},__setThumbsInitialPositions:function(){var t=this.config.thumbWidth,e=(this.__targetElement.clientWidth-t)/((this.config.data.length-1)/this.config.stepSize);this.snap(e*this.config.startPosition,this.__thumbLeft,!0),this.isRangeMode()&&this.snap(e*this.config.endPosition,this.__thumbRight,!0)},__updateMarkerProgress:function(){for(var t=this.__trackMarkerElements.length;t--;)this.__trackMarkerElements[t].offsetLeft<=this.__thumbLeft.getLeft()?this.__trackMarkerElements[t].classList.add("completed"):this.__trackMarkerElements[t].classList.remove("completed")},__updateMarkerRange:function(){for(var t=this.__trackMarkerElements.length;t--;)this.__trackMarkerElements[t].offsetLeft>=this.__thumbLeft.getLeft()&&this.__trackMarkerElements[t].offsetLeft<=this.__thumbRight.getRight()?this.__trackMarkerElements[t].classList.add("completed"):this.__trackMarkerElements[t].classList.remove("completed")},isPositionOutOfBounds:function(t){var e=this.config.data.length-1;return t>(this.__targetElement.clientWidth-this.config.thumbWidth)/e*e||t<0},areThumbsTooClose:function(t){var e=this.config.data.length-1,i=(this.__targetElement.clientWidth-this.config.thumbWidth)/e;return this.__thumbRight.getLeft()-this.__thumbLeft.getRight()<i/this.__multiThumbProximityBuffor},getMarkerByIndex:function(t){return{index:t,data:this.config.data[t]}},fire:function(t,e){if(this.config.handlers&&this.config.handlers[t])for(var i=this.config.handlers[t].length;i--;)this.config.handlers[t][i].apply(this,e)},__isDOMElement:function(t){return t instanceof Element},__isString:function(t){return"string"==typeof t}},function(t,i){return new e(t,i)}});